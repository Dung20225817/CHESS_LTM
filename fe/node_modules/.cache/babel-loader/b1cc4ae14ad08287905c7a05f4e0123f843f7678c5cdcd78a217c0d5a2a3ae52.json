{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useEffect, useRef, useState, useCallback } from \"react\";\nfunction makeWsUrl() {\n  const proto = window.location.protocol === \"https:\" ? \"wss:\" : \"ws:\";\n  const envHost = process.env.REACT_APP_WS_HOST;\n  const host = envHost || `${window.location.hostname}:8765`;\n  return `${proto}//${host}`;\n}\nexport default function useChessSocket(roomId, onUpdate) {\n  _s();\n  const wsRef = useRef(null);\n  const [connected, setConnected] = useState(false);\n  const [playerColor, setPlayerColor] = useState(null);\n  const reconnectTimeoutRef = useRef(null);\n  const parseAndDispatch = useCallback(raw => {\n    console.log('üì• Received from server:', raw);\n\n    // H·ªó tr·ª£ nhi·ªÅu JSON objects\n    const matches = raw.match(/{[^}]+}/g);\n    if (!matches) {\n      console.warn('‚ö†Ô∏è No JSON found in message:', raw);\n      return;\n    }\n    for (const jsonStr of matches) {\n      try {\n        const data = JSON.parse(jsonStr);\n        console.log('üì¶ Parsed message:', data);\n        if (!data || !data.type) {\n          console.warn('‚ö†Ô∏è Message missing type:', data);\n          continue;\n        }\n        switch (data.type) {\n          // Server g√°n m√†u qu√¢n cho ng∆∞·ªùi ch∆°i\n          case \"joined\":\n          case \"assignColor\":\n            if (data.color === \"white\" || data.color === \"black\") {\n              console.log('üé® Player color assigned:', data.color);\n              setPlayerColor(data.color);\n\n              // N·∫øu c√≥ FEN k√®m theo (b√†n c·ªù kh·ªüi t·∫°o)\n              if (data.fen) {\n                onUpdate(data.fen, data.turn || \"white\", null);\n              }\n            }\n            break;\n\n          // C·∫≠p nh·∫≠t tr·∫°ng th√°i b√†n c·ªù\n          case \"state\":\n          case \"update\":\n            console.log('‚ôüÔ∏è Board update:', {\n              fen: data.fen,\n              turn: data.turn\n            });\n            onUpdate(data.fen || \"\", data.turn || \"white\", null, undefined);\n            break;\n\n          // Game k·∫øt th√∫c\n          case \"gameOver\":\n            console.log('üèÅ Game over:', {\n              winner: data.winner,\n              reason: data.reason\n            });\n            onUpdate(data.fen || \"\", data.turn || \"white\", data.winner || null, data.reason);\n            break;\n\n          // N∆∞·ªõc ƒëi ƒë√£ ƒë∆∞·ª£c x·ª≠ l√Ω\n          case \"move\":\n            console.log('üëü Move processed:', {\n              fen: data.fen,\n              turn: data.turn\n            });\n            if (data.fen) {\n              onUpdate(data.fen, data.turn || \"white\", data.gameOver || null, data.reason);\n            }\n            break;\n\n          // L·ªói t·ª´ server\n          case \"error\":\n            console.error('‚ùå Server error:', data.msg);\n            // C√≥ th·ªÉ hi·ªÉn th·ªã toast/notification cho user\n            break;\n          default:\n            console.debug('‚ùì Unknown message type:', data.type, data);\n        }\n      } catch (err) {\n        console.error('üí• JSON parse error:', jsonStr, err);\n      }\n    }\n  }, [onUpdate]);\n  useEffect(() => {\n    // N·∫øu kh√¥ng c√≥ roomId, ng·∫Øt k·∫øt n·ªëi\n    if (!roomId) {\n      console.log('üö´ No room ID, disconnecting...');\n      if (wsRef.current) {\n        try {\n          wsRef.current.close();\n        } catch {}\n        wsRef.current = null;\n      }\n      setConnected(false);\n      setPlayerColor(null);\n      return;\n    }\n    console.log('üîå Connecting to room:', roomId);\n    const url = makeWsUrl();\n    const ws = new WebSocket(url);\n    wsRef.current = ws;\n    const cleanup = () => {\n      console.log('üßπ Cleaning up WebSocket');\n      try {\n        ws.close();\n      } catch {}\n      if (wsRef.current === ws) {\n        wsRef.current = null;\n      }\n      setConnected(false);\n    };\n    ws.onopen = () => {\n      console.log('‚úÖ WebSocket connected');\n      setConnected(true);\n\n      // G·ª≠i JOIN ngay khi k·∫øt n·ªëi\n      try {\n        const joinMsg = JSON.stringify({\n          type: \"join\",\n          room: roomId\n        });\n        console.log('üì§ Sending JOIN:', joinMsg);\n        ws.send(joinMsg);\n      } catch (e) {\n        console.error('‚ùå Failed to send JOIN:', e);\n      }\n    };\n    ws.onmessage = ev => {\n      const data = typeof ev.data === \"string\" ? ev.data : \"\";\n      parseAndDispatch(data);\n    };\n    ws.onerror = ev => {\n      console.error('‚ùå WebSocket error:', ev);\n    };\n    ws.onclose = ev => {\n      console.log('üîå WebSocket closed:', ev.code, ev.reason);\n      cleanup();\n\n      // Auto-reconnect sau 3 gi√¢y (n·∫øu v·∫´n c√≤n roomId)\n      if (roomId) {\n        console.log('üîÑ Will attempt reconnect in 3s...');\n        reconnectTimeoutRef.current = setTimeout(() => {\n          console.log('üîÑ Attempting reconnect...');\n          // Component s·∫Ω t·ª± reconnect v√¨ useEffect ch·∫°y l·∫°i\n        }, 3000);\n      }\n    };\n\n    // Cleanup khi unmount ho·∫∑c roomId thay ƒë·ªïi\n    return () => {\n      console.log('üîö useChessSocket cleanup');\n      if (reconnectTimeoutRef.current) {\n        clearTimeout(reconnectTimeoutRef.current);\n        reconnectTimeoutRef.current = null;\n      }\n      try {\n        ws.close();\n      } catch {}\n      if (wsRef.current === ws) {\n        wsRef.current = null;\n      }\n      setConnected(false);\n    };\n  }, [roomId, parseAndDispatch]);\n  const sendMove = useCallback(move => {\n    const ws = wsRef.current;\n    if (!ws || ws.readyState !== WebSocket.OPEN) {\n      console.warn('‚ö†Ô∏è Cannot send move: WebSocket not open');\n      return false;\n    }\n    try {\n      const moveMsg = JSON.stringify({\n        type: \"move\",\n        move\n      });\n      console.log('üì§ Sending move:', moveMsg);\n      ws.send(moveMsg);\n      return true;\n    } catch (e) {\n      console.error('‚ùå Failed to send move:', e);\n      return false;\n    }\n  }, []);\n  const sendChat = useCallback(text => {\n    const ws = wsRef.current;\n    if (!ws || ws.readyState !== WebSocket.OPEN) {\n      console.warn('‚ö†Ô∏è Cannot send chat: WebSocket not open');\n      return false;\n    }\n    try {\n      const chatMsg = JSON.stringify({\n        type: \"chat\",\n        text\n      });\n      console.log('üì§ Sending chat:', chatMsg);\n      ws.send(chatMsg);\n      return true;\n    } catch (e) {\n      console.error('‚ùå Failed to send chat:', e);\n      return false;\n    }\n  }, []);\n  const leaveRoom = useCallback(() => {\n    console.log('üö™ Leaving room');\n    const ws = wsRef.current;\n    if (ws) {\n      try {\n        ws.send(JSON.stringify({\n          type: \"leave\",\n          room: roomId\n        }));\n      } catch (e) {\n        console.error('‚ùå Failed to send leave message:', e);\n      }\n      try {\n        ws.close();\n      } catch {}\n      wsRef.current = null;\n    }\n    setConnected(false);\n    setPlayerColor(null);\n  }, [roomId]);\n  return {\n    connected,\n    playerColor,\n    sendMove,\n    sendChat,\n    leaveRoom\n  };\n}\n_s(useChessSocket, \"tk6srolvj0cTz68nhYSaSIZ+qpo=\");","map":{"version":3,"names":["useEffect","useRef","useState","useCallback","makeWsUrl","proto","window","location","protocol","envHost","process","env","REACT_APP_WS_HOST","host","hostname","useChessSocket","roomId","onUpdate","_s","wsRef","connected","setConnected","playerColor","setPlayerColor","reconnectTimeoutRef","parseAndDispatch","raw","console","log","matches","match","warn","jsonStr","data","JSON","parse","type","color","fen","turn","undefined","winner","reason","gameOver","error","msg","debug","err","current","close","url","ws","WebSocket","cleanup","onopen","joinMsg","stringify","room","send","e","onmessage","ev","onerror","onclose","code","setTimeout","clearTimeout","sendMove","move","readyState","OPEN","moveMsg","sendChat","text","chatMsg","leaveRoom"],"sources":["D:/LTM/CHESS/fe/src/components/context/useChessSocket.ts"],"sourcesContent":["import { useEffect, useRef, useState, useCallback } from \"react\";\r\n\r\ntype UpdateCallback = (fen: string, turn: string, gameOver: string | null, reason?: string) => void;\r\n\r\nfunction makeWsUrl(): string {\r\n  const proto = window.location.protocol === \"https:\" ? \"wss:\" : \"ws:\";\r\n  const envHost = process.env.REACT_APP_WS_HOST;\r\n  const host = envHost || `${window.location.hostname}:8765`;\r\n  return `${proto}//${host}`;\r\n}\r\n\r\nexport default function useChessSocket(roomId: string, onUpdate: UpdateCallback) {\r\n  const wsRef = useRef<WebSocket | null>(null);\r\n  const [connected, setConnected] = useState(false);\r\n  const [playerColor, setPlayerColor] = useState<\"white\" | \"black\" | null>(null);\r\n  const reconnectTimeoutRef = useRef<NodeJS.Timeout | null>(null);\r\n\r\n  const parseAndDispatch = useCallback((raw: string) => {\r\n    console.log('üì• Received from server:', raw);\r\n    \r\n    // H·ªó tr·ª£ nhi·ªÅu JSON objects\r\n    const matches = raw.match(/{[^}]+}/g);\r\n    if (!matches) {\r\n      console.warn('‚ö†Ô∏è No JSON found in message:', raw);\r\n      return;\r\n    }\r\n\r\n    for (const jsonStr of matches) {\r\n      try {\r\n        const data = JSON.parse(jsonStr);\r\n        console.log('üì¶ Parsed message:', data);\r\n        \r\n        if (!data || !data.type) {\r\n          console.warn('‚ö†Ô∏è Message missing type:', data);\r\n          continue;\r\n        }\r\n\r\n        switch (data.type) {\r\n          // Server g√°n m√†u qu√¢n cho ng∆∞·ªùi ch∆°i\r\n          case \"joined\":\r\n          case \"assignColor\":\r\n            if (data.color === \"white\" || data.color === \"black\") {\r\n              console.log('üé® Player color assigned:', data.color);\r\n              setPlayerColor(data.color);\r\n              \r\n              // N·∫øu c√≥ FEN k√®m theo (b√†n c·ªù kh·ªüi t·∫°o)\r\n              if (data.fen) {\r\n                onUpdate(data.fen, data.turn || \"white\", null);\r\n              }\r\n            }\r\n            break;\r\n\r\n          // C·∫≠p nh·∫≠t tr·∫°ng th√°i b√†n c·ªù\r\n          case \"state\":\r\n          case \"update\":\r\n            console.log('‚ôüÔ∏è Board update:', { fen: data.fen, turn: data.turn });\r\n            onUpdate(\r\n              data.fen || \"\", \r\n              data.turn || \"white\", \r\n              null, \r\n              undefined\r\n            );\r\n            break;\r\n\r\n          // Game k·∫øt th√∫c\r\n          case \"gameOver\":\r\n            console.log('üèÅ Game over:', { winner: data.winner, reason: data.reason });\r\n            onUpdate(\r\n              data.fen || \"\",\r\n              data.turn || \"white\",\r\n              data.winner || null,\r\n              data.reason\r\n            );\r\n            break;\r\n\r\n          // N∆∞·ªõc ƒëi ƒë√£ ƒë∆∞·ª£c x·ª≠ l√Ω\r\n          case \"move\":\r\n            console.log('üëü Move processed:', { fen: data.fen, turn: data.turn });\r\n            if (data.fen) {\r\n              onUpdate(\r\n                data.fen,\r\n                data.turn || \"white\",\r\n                data.gameOver || null,\r\n                data.reason\r\n              );\r\n            }\r\n            break;\r\n\r\n          // L·ªói t·ª´ server\r\n          case \"error\":\r\n            console.error('‚ùå Server error:', data.msg);\r\n            // C√≥ th·ªÉ hi·ªÉn th·ªã toast/notification cho user\r\n            break;\r\n\r\n          default:\r\n            console.debug('‚ùì Unknown message type:', data.type, data);\r\n        }\r\n      } catch (err) {\r\n        console.error('üí• JSON parse error:', jsonStr, err);\r\n      }\r\n    }\r\n  }, [onUpdate]);\r\n\r\n  useEffect(() => {\r\n    // N·∫øu kh√¥ng c√≥ roomId, ng·∫Øt k·∫øt n·ªëi\r\n    if (!roomId) {\r\n      console.log('üö´ No room ID, disconnecting...');\r\n      if (wsRef.current) {\r\n        try { \r\n          wsRef.current.close(); \r\n        } catch {}\r\n        wsRef.current = null;\r\n      }\r\n      setConnected(false);\r\n      setPlayerColor(null);\r\n      return;\r\n    }\r\n\r\n    console.log('üîå Connecting to room:', roomId);\r\n    const url = makeWsUrl();\r\n    const ws = new WebSocket(url);\r\n    wsRef.current = ws;\r\n\r\n    const cleanup = () => {\r\n      console.log('üßπ Cleaning up WebSocket');\r\n      try { ws.close(); } catch {}\r\n      if (wsRef.current === ws) {\r\n        wsRef.current = null;\r\n      }\r\n      setConnected(false);\r\n    };\r\n\r\n    ws.onopen = () => {\r\n      console.log('‚úÖ WebSocket connected');\r\n      setConnected(true);\r\n      \r\n      // G·ª≠i JOIN ngay khi k·∫øt n·ªëi\r\n      try {\r\n        const joinMsg = JSON.stringify({ type: \"join\", room: roomId });\r\n        console.log('üì§ Sending JOIN:', joinMsg);\r\n        ws.send(joinMsg);\r\n      } catch (e) {\r\n        console.error('‚ùå Failed to send JOIN:', e);\r\n      }\r\n    };\r\n\r\n    ws.onmessage = (ev) => {\r\n      const data = typeof ev.data === \"string\" ? ev.data : \"\";\r\n      parseAndDispatch(data);\r\n    };\r\n\r\n    ws.onerror = (ev) => {\r\n      console.error('‚ùå WebSocket error:', ev);\r\n    };\r\n\r\n    ws.onclose = (ev) => {\r\n      console.log('üîå WebSocket closed:', ev.code, ev.reason);\r\n      cleanup();\r\n      \r\n      // Auto-reconnect sau 3 gi√¢y (n·∫øu v·∫´n c√≤n roomId)\r\n      if (roomId) {\r\n        console.log('üîÑ Will attempt reconnect in 3s...');\r\n        reconnectTimeoutRef.current = setTimeout(() => {\r\n          console.log('üîÑ Attempting reconnect...');\r\n          // Component s·∫Ω t·ª± reconnect v√¨ useEffect ch·∫°y l·∫°i\r\n        }, 3000);\r\n      }\r\n    };\r\n\r\n    // Cleanup khi unmount ho·∫∑c roomId thay ƒë·ªïi\r\n    return () => {\r\n      console.log('üîö useChessSocket cleanup');\r\n      \r\n      if (reconnectTimeoutRef.current) {\r\n        clearTimeout(reconnectTimeoutRef.current);\r\n        reconnectTimeoutRef.current = null;\r\n      }\r\n      \r\n      try { ws.close(); } catch {}\r\n      if (wsRef.current === ws) {\r\n        wsRef.current = null;\r\n      }\r\n      setConnected(false);\r\n    };\r\n  }, [roomId, parseAndDispatch]);\r\n\r\n  const sendMove = useCallback((move: string) => {\r\n    const ws = wsRef.current;\r\n    if (!ws || ws.readyState !== WebSocket.OPEN) {\r\n      console.warn('‚ö†Ô∏è Cannot send move: WebSocket not open');\r\n      return false;\r\n    }\r\n    \r\n    try {\r\n      const moveMsg = JSON.stringify({ type: \"move\", move });\r\n      console.log('üì§ Sending move:', moveMsg);\r\n      ws.send(moveMsg);\r\n      return true;\r\n    } catch (e) {\r\n      console.error('‚ùå Failed to send move:', e);\r\n      return false;\r\n    }\r\n  }, []);\r\n\r\n  const sendChat = useCallback((text: string) => {\r\n    const ws = wsRef.current;\r\n    if (!ws || ws.readyState !== WebSocket.OPEN) {\r\n      console.warn('‚ö†Ô∏è Cannot send chat: WebSocket not open');\r\n      return false;\r\n    }\r\n    \r\n    try {\r\n      const chatMsg = JSON.stringify({ type: \"chat\", text });\r\n      console.log('üì§ Sending chat:', chatMsg);\r\n      ws.send(chatMsg);\r\n      return true;\r\n    } catch (e) {\r\n      console.error('‚ùå Failed to send chat:', e);\r\n      return false;\r\n    }\r\n  }, []);\r\n\r\n  const leaveRoom = useCallback(() => {\r\n    console.log('üö™ Leaving room');\r\n    const ws = wsRef.current;\r\n    \r\n    if (ws) {\r\n      try { \r\n        ws.send(JSON.stringify({ type: \"leave\", room: roomId })); \r\n      } catch (e) {\r\n        console.error('‚ùå Failed to send leave message:', e);\r\n      }\r\n      \r\n      try { \r\n        ws.close(); \r\n      } catch {}\r\n      \r\n      wsRef.current = null;\r\n    }\r\n    \r\n    setConnected(false);\r\n    setPlayerColor(null);\r\n  }, [roomId]);\r\n\r\n  return {\r\n    connected,\r\n    playerColor,\r\n    sendMove,\r\n    sendChat,\r\n    leaveRoom,\r\n  };\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}